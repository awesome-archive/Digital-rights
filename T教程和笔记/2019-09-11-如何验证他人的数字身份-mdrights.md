---
date: 2019-09-14
author: MDrights
---

# 如何验证他人的数字身份


> 前言：本文为作者本人经过自己实践和英文世界相关数字安全组织的资料/手册整合而成。若有错误或遗漏欢迎讨论和补充。

## 背景

之前的文章[《在线匿名FAQ》](https://github.com/mdrights/Digital-rights/blob/master/A%E5%8C%BF%E5%90%8D%E7%AD%96%E7%95%A5/%E5%9C%A8%E7%BA%BF%E5%8C%BF%E5%90%8DFAQ.md)介绍了我们该如何在网络上隐匿自己的身份，特别是在需要隐藏自己地理位置时的处境。然而这篇文章将教我们如何在网络上标识自己的身份，同时科学有效地验证朋友、同道、战友的身份。这当然也是非常重要的技能，但往往被很多人忽视。

你可能要问了，又是要隐匿身份，又是要验证身份，这会不会矛盾呢？

回答是不会矛盾滴。在网络（还有现实世界）不被记录和追踪是人类天然的自由。私密地通讯也是每个个体的权利。为了保证私密，除了需要加密，还有就是要确认与你通讯的人就是你要通讯的人了（绕吧？）。身份验证就是在这里被派上了用场。当然了，不管是匿名还是验证身份，都是来自实实在在的人类需求，或许人类需求就是这么「矛盾」。

而且这两者可以加在一起使用。你可以科学地验证一个匿名身份，即比如验证一个一直用匿名身份跟你通讯的素未谋面的人。你或许并不需要知道TA的真实身份，但只要确认：使用这个匿名身份的人一直就是这个人，没有变过。


## 威胁模式（Threat Model）

因此就要提到对于「身份验证」的威胁模式了。  

我们要验证他人的身份，无非是为了防止对方的身份被人冒用，用术语说也算是一种「中间人攻击」（MITM）。这种攻击手法对于我们很多曾经身处困境中、参与过敏感事件的人来说，应该是比较熟悉了。

曾几何时，我经常收到一些（线下认识的）朋友用匿名方式给我发的邮件和信息，我们便这样互通着有无。然而这样并不能让我放心，我怎样才能确认这个网络那一头的人就是我认识的朋友呢？频繁变换身份的TA是不是此时正在被国安控制着跟我说话？甚至直接被国安/国保冒充？我不是不信任我的朋友，但这种没去确认和思考的事，最容易成为隐患而造成无可挽回的损失。


## 验证数字身份的几种方法

总有技术能解决我们的痛点。尝试介绍几种，欢迎评论和补充。身份验证这件事，更考验的是完整的逻辑链，即从头到尾都滴水不漏是最理想的了。所以这也对每一个使用者的思考能力有一定的要求，也即：不存在一劳永逸的一种技术能傻瓜式地提供解决方案。如果有，那肯定是骗子。

让我们从易到难地讲开：

### 方法0 声音辨识法
这个肯定是最容易上手的了。  
优点：人声唯一性高，只要线下认识这个人，基本都能靠声识人。  
缺点：1）如果没听过对方的声音，则无法辨别；2）现在有的软件有变声功能……   

### 方法1 Signal 的安全号码
Signal 有个功能「验证安全号码」（verfiy safety number）——当与他人在私聊界面点击TA的人名（或电话号码）进入对方页面，即可查看你跟对方的这一串号码（经过密码学方法生成，你和对方的是相同的，且全世界只有你和对方相同，这样就保证了你沟通的就是TA（的设备），不是别人（的设备）。但要双方确认这安全号码是相同的，最好是线下面对面确认（Signal 也提供了二维码可以互相扫）。当然也可以通过其他方式如电话，或其他IM（但就不够严谨了）。

优点：用户友好，易于使用。
局限：这个方法本质上验证的还是TA所持有的设备（手机），及其上面安装的 Signal。如果设备丢失或被坏人拿去使用或被黑客攻入，这种验证就失败了。其实甚至只要TA重装了 Signal app 或系统，这个安全码就变更了，需要双方重新验证。

### 方法2 PGP 密钥签名
这是目前最可靠的验证方法了，也是本文的重点。  
openPGP 是一种开源的密码学加密技术（公钥-私钥非对称加密），基本有两种用法：  

首先需要生成属于自己的公钥-私钥密钥对，将公钥公开（比如放到网站上，然后在社交网络帐号上公开你的公钥指纹即可），  
- 对方就可以用你给出的公钥发加密邮件给你，从密码学上保证只有你才能解密邮件（文件也可以这样操作）；
- 如果你的邮件或文件是用你的私钥签名的，对方也可以用你的公钥来验证这邮件或文件是你的。

所以，简而言之：**公钥用于加密，私钥用于签名**（方便记忆了吧）~

现在就来讲讲这第二种用法。这种用法也基本有两三种工具可供大家使用： 
  
- 如果你熟悉（或者说不惧怕）命令行（Linux OR MacOS），你可以直接使用强大而安全的 GnuGP （Linux 和 macOS 都默认安装），再配合其他邮件服务——这也是最推荐的方式，因为干活的工具越少，来自软件的bug和攻击者的攻击面也越少。（可参考二翔子的[如何创建完美的GPG密钥对](https://github.com/mdrights/Digital-rights/blob/master/T%E6%95%99%E7%A8%8B%E5%92%8C%E7%AC%94%E8%AE%B0/2017-01-01-%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA%E5%AE%8C%E7%BE%8E%E7%9A%84GPG%E5%AF%86%E9%92%A5%E5%AF%B9-2xiangzi.md)）    
- 如果你用邮件客户端，推荐 Thunderbird + enigmail，可以不用接触命令即可生成、管理、使用你的密钥。这也是比较推荐的方式，因为这里要特别强调：
```
	密钥中的私钥，跟现实世界的钥匙一样，必须由自己保管，不可丢失、落入他人手中。
```
- 一些安全邮件服务商也是使用`PGP`的，但注意：  
	1. `PGP`或`openPGP`只是一种协议，给用户使用还需要用代码把这种协议实现出来。各邮件服务商提供`PGP`加密/签名服务时用的可能是自己开发的`PGP`实现工具。如果他们的实现是开源的且经过安全审计则还好，否则就呵呵了。
	2. 上面提到，密钥形式的加密/签名技术跟密码形式的技术在原理和用法方面都大不一样，因此只有当用户能完全掌控自己的密钥对（私钥+公钥），才算真正用好了`PGP`技术（**非常重要**)。但现在市面上的即使声称是安全的邮件服务商也不都能提供用户自己管理密钥的功能（据本人所知只有`Protonmail`和`Mailfence`）。如果你是这些服务的使用者，没法直接在这种邮件服务内使用自己的密钥进行签名、加密解密的操作（虽然服务商已经帮你在邮件存储、传输时加密了），那么就得另想办法了。

下面我们就来探讨一下利用好`PGP`签名的场景：

- 如果你的邮件服务商原生支持邮件签名（即他们在进行邮件加密时已有为你生成一对密钥对，并在界面上提供加密、解密、签名等功能选项），那直接使用即可。（如果服务商虽然提供加密邮件服务，但界面上没提供签名等功能选项的话那就没办法了）  
- 如果你的邮件服务商**没**提供签名功能，那么：  
	- 如果你的邮件服务商允许你使用第三方邮件客户端（即支持 POP、IMAP 等协议），那么你可以把 Thunderbird + Enigmail 用起来（EFF有篇[详细的教程](https://ssd.eff.org/en/module/how-use-pgp-mac-os-x)（英文），[中文非官方翻译版](https://ocftw.github.io/ssd.eff.org/zh_TW/module/how-use-pgp-mac-os-x.html)）。不过很多安全邮件服务商因为用的是自己开发的`PGP`实现工具，因此无法对接第三方邮件客户端。   
	- 如果你的邮件服务商**没法**使用第三方邮件客户端，那么你可能需要半自动或手动签名了，可以尝试这些工具：   
		- 用浏览器 (Firefox 和 Chrome) 插件半自动完成签名：[Mailvelope](https://www.mailvelope.com/)。它的使用方法见[官方文档](https://www.mailvelope.com/en/help)，也有不少中文教程如[这里](https://www.cnbeining.com/2014/09/tutorial-how-to-use-mailvelope-to-sign-your-email-and-pgp-encryption-3-months-and-finally-finished/)（但请自己判断准确性）。  
			- 局限：虽然 Mailvelope 已经支持很多邮件服务商的网页版（如 Gmail、Yahoo、Outlook），但可能仍有邮件服务不被支持。     
			- 用这个工具需要注意：你的私钥（不管是导入进去的还是由它生成的），都会存放在电脑磁盘上浏览器使用的某处文件夹内（除非你选择`GnuPG`作为它的后端）。严格来讲并不安全，虽然私钥是加密存储且要求设置密码，但这意味着密钥文件会被拷贝走。最终还是取决于你的浏览器和电脑系统是否足够安全，以及你的电脑被他人接触的可能性。且对于想把私钥放在U盘的用户也不太方便。建议高风险的用户慎用。（参考：[官方FAQ的相关问答](https://www.mailvelope.com/en/faq#private_key_security)）
		- 手动借助其他工具，如：[GPGTools](https://gpgtools.org/)（MacOS）、[GPG4Win](https://www.gpg4win.de/index.thml)（Windows），把你要签名的文字或文件导入这些工具，生成签名后再贴入邮件正文输入框内。（这些工具的教程也不少了，比如[这里](https://www.ezloo.com/2015/01/pgp_for_mac_os_x.html), 和[这里](https://zhuanlan.zhihu.com/p/28902093)）


## 总结一下

如果你阅读到这里，那么恭喜你！  

PGP 密钥签名是目前最可靠的验证他人数字身份的方法，大家（特别是需要经常进行敏感操作的朋友）应该把它用起来。  

还要强调一点：  

> PGP 私钥是非常私密的个人物品，妥善保管且要对其设置密码。建议在电脑上生成了密钥对之后，把私钥导出到一个USB盘上（当然这个U盘也可以加密），这个U盘就相当于你的钥匙，随身携带，用的时候插入电脑，不用时则拔出。电脑里则不再放这个私钥了以防电脑丢失或被坏人（如`popo`）冒用。

> **强烈建议**：不在手机（特别是安卓）上各种使用`PGP`密钥，最佳实践是敏感邮件就别在手机上收发了（当然若一定要使用也是有相关工具的）。原因很多，比如：手机设备更容易丢失或被冒用；安卓系统的令人担忧的安全性等等。


最后，如果你没有被`PGP`所吓倒，可以继续阅读：[PGP签名的最佳实践](https://github.com/mdrights/Digital-rights/blob/master/T%E6%95%99%E7%A8%8B%E5%92%8C%E7%AC%94%E8%AE%B0/2019-04-17-OpenPGP-%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-Mailfence.md)。

